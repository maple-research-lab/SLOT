[2025-04-12 11:07:54,418] [[32m    INFO[0m]: PyTorch version 2.5.1 available. (config.py:54)[0m
INFO 04-12 11:08:01 __init__.py:190] Automatically detected platform cuda.
[2025-04-12 11:08:02,248] [[32m    INFO[0m]: --- LOADING MODEL --- (pipeline.py:189)[0m
[2025-04-12 11:08:10,323] [[32m    INFO[0m]: This model supports multiple tasks: {'embed', 'classify', 'reward', 'generate', 'score'}. Defaulting to 'generate'. (config.py:542)[0m
[2025-04-12 11:08:10,511] [[32m    INFO[0m]: Defaulting to use mp for distributed inference (config.py:1401)[0m
[2025-04-12 11:08:10,515] [[32m    INFO[0m]: Initializing a V0 LLM engine (v0.7.2) with config: model='~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct', speculative_config=None, tokenizer='~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=main, override_neuron_config=None, tokenizer_revision=main, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=8, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=1234, served_model_name=~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":128}, use_cached_outputs=False,  (llm_engine.py:234)[0m
[2025-04-12 11:08:10,820] [[33m WARNING[0m]: Reducing Torch parallelism from 64 threads to 1 to avoid unnecessary CPU contention. Set OMP_NUM_THREADS in the external environment to tune this value as needed. (multiproc_worker_utils.py:300)[0m
[2025-04-12 11:08:10,823] [[32m    INFO[0m]: Setting Triton cache manager to: vllm.triton_utils.custom_cache_manager:CustomCacheManager (custom_cache_manager.py:19)[0m
[2025-04-12 11:08:11,580] [[32m    INFO[0m]: Using Flash Attention backend. (cuda.py:230)[0m
INFO 04-12 11:08:17 __init__.py:190] Automatically detected platform cuda.
INFO 04-12 11:08:17 __init__.py:190] Automatically detected platform cuda.
INFO 04-12 11:08:17 __init__.py:190] Automatically detected platform cuda.
INFO 04-12 11:08:17 __init__.py:190] Automatically detected platform cuda.
INFO 04-12 11:08:17 __init__.py:190] Automatically detected platform cuda.
INFO 04-12 11:08:17 __init__.py:190] Automatically detected platform cuda.
INFO 04-12 11:08:17 __init__.py:190] Automatically detected platform cuda.
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:20 multiproc_worker_utils.py:229] Worker ready; awaiting tasks
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:20 multiproc_worker_utils.py:229] Worker ready; awaiting tasks
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:20 multiproc_worker_utils.py:229] Worker ready; awaiting tasks
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:20 multiproc_worker_utils.py:229] Worker ready; awaiting tasks
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:20 multiproc_worker_utils.py:229] Worker ready; awaiting tasks
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:20 multiproc_worker_utils.py:229] Worker ready; awaiting tasks
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:20 multiproc_worker_utils.py:229] Worker ready; awaiting tasks
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:25 cuda.py:230] Using Flash Attention backend.
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:25 cuda.py:230] Using Flash Attention backend.
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:25 cuda.py:230] Using Flash Attention backend.
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:25 cuda.py:230] Using Flash Attention backend.
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:25 cuda.py:230] Using Flash Attention backend.
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:25 cuda.py:230] Using Flash Attention backend.
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:25 cuda.py:230] Using Flash Attention backend.
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:28 utils.py:950] Found nccl from library libnccl.so.2
[2025-04-12 11:08:28,609] [[32m    INFO[0m]: Found nccl from library libnccl.so.2 (utils.py:950)[0m
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:28 utils.py:950] Found nccl from library libnccl.so.2
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:28 utils.py:950] Found nccl from library libnccl.so.2
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:28 utils.py:950] Found nccl from library libnccl.so.2
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:28 utils.py:950] Found nccl from library libnccl.so.2
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:28 utils.py:950] Found nccl from library libnccl.so.2
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:28 utils.py:950] Found nccl from library libnccl.so.2
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:28 pynccl.py:69] vLLM is using nccl==2.21.5
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:28 pynccl.py:69] vLLM is using nccl==2.21.5
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:28 pynccl.py:69] vLLM is using nccl==2.21.5
[2025-04-12 11:08:28,610] [[32m    INFO[0m]: vLLM is using nccl==2.21.5 (pynccl.py:69)[0m
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:28 pynccl.py:69] vLLM is using nccl==2.21.5
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:28 pynccl.py:69] vLLM is using nccl==2.21.5
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:28 pynccl.py:69] vLLM is using nccl==2.21.5
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:28 pynccl.py:69] vLLM is using nccl==2.21.5
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:34 custom_all_reduce_utils.py:244] reading GPU P2P access cache from ~/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3,4,5,6,7.json
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:34 custom_all_reduce_utils.py:244] reading GPU P2P access cache from ~/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3,4,5,6,7.json
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:34 custom_all_reduce_utils.py:244] reading GPU P2P access cache from ~/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3,4,5,6,7.json
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:34 custom_all_reduce_utils.py:244] reading GPU P2P access cache from ~/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3,4,5,6,7.json
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:34 custom_all_reduce_utils.py:244] reading GPU P2P access cache from ~/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3,4,5,6,7.json
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:34 custom_all_reduce_utils.py:244] reading GPU P2P access cache from ~/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3,4,5,6,7.json
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:34 custom_all_reduce_utils.py:244] reading GPU P2P access cache from ~/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3,4,5,6,7.json
[2025-04-12 11:08:34,325] [[32m    INFO[0m]: reading GPU P2P access cache from ~/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3,4,5,6,7.json (custom_all_reduce_utils.py:244)[0m
[2025-04-12 11:08:34,739] [[32m    INFO[0m]: vLLM message queue communication handle: Handle(connect_ip='127.0.0.1', local_reader_ranks=[1, 2, 3, 4, 5, 6, 7], buffer_handle=(7, 4194304, 6, 'psm_14e9c088'), local_subscribe_port=56945, remote_subscribe_port=None) (shm_broadcast.py:258)[0m
[2025-04-12 11:08:34,754] [[32m    INFO[0m]: Starting to load model ~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct... (model_runner.py:1110)[0m
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:34 model_runner.py:1110] Starting to load model ~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct...
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:34 model_runner.py:1110] Starting to load model ~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct...
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:34 model_runner.py:1110] Starting to load model ~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct...
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:34 model_runner.py:1110] Starting to load model ~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct...
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:34 model_runner.py:1110] Starting to load model ~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct...
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:34 model_runner.py:1110] Starting to load model ~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct...
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:34 model_runner.py:1110] Starting to load model ~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct...

Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:05,  1.77s/it]
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:37 model_runner.py:1115] Loading model weights took 1.9029 GB

Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:03<00:03,  1.54s/it]
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:39 model_runner.py:1115] Loading model weights took 1.9029 GB
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:39 model_runner.py:1115] Loading model weights took 1.9029 GB

Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:04<00:01,  1.52s/it]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.04it/s]

Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:04<00:00,  1.19s/it]

[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:39 model_runner.py:1115] Loading model weights took 1.9029 GB
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:39 model_runner.py:1115] Loading model weights took 1.9029 GB
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:39 model_runner.py:1115] Loading model weights took 1.9029 GB
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:39 model_runner.py:1115] Loading model weights took 1.9029 GB
[2025-04-12 11:08:39,958] [[32m    INFO[0m]: Loading model weights took 1.9029 GB (model_runner.py:1115)[0m
[1;36m(VllmWorkerProcess pid=3236832)[0;0m [2025-04-12 11:08:42,408] [[33m WARNING[0m]: ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/vllm/worker/model_runner.py:1828: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[1;36m(VllmWorkerProcess pid=3236833)[0;0m [2025-04-12 11:08:42,408] [[33m WARNING[0m]: ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/vllm/worker/model_runner.py:1828: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[1;36m(VllmWorkerProcess pid=3236834)[0;0m [2025-04-12 11:08:42,408] [[33m WARNING[0m]: ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/vllm/worker/model_runner.py:1828: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[1;36m(VllmWorkerProcess pid=3236835)[0;0m [2025-04-12 11:08:42,408] [[33m WARNING[0m]: ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/vllm/worker/model_runner.py:1828: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[1;36m(VllmWorkerProcess pid=3236832)[0;0m   lm_head_weight = torch.load(lm_local, map_location=hidden_states_cur.device).to(dtype=torch.bfloat16)
[1;36m(VllmWorkerProcess pid=3236833)[0;0m   lm_head_weight = torch.load(lm_local, map_location=hidden_states_cur.device).to(dtype=torch.bfloat16)
[1;36m(VllmWorkerProcess pid=3236834)[0;0m   lm_head_weight = torch.load(lm_local, map_location=hidden_states_cur.device).to(dtype=torch.bfloat16)
[1;36m(VllmWorkerProcess pid=3236835)[0;0m   lm_head_weight = torch.load(lm_local, map_location=hidden_states_cur.device).to(dtype=torch.bfloat16)
[1;36m(VllmWorkerProcess pid=3236832)[0;0m  (warnings.py:110)[0m
[1;36m(VllmWorkerProcess pid=3236833)[0;0m  (warnings.py:110)[0m
[1;36m(VllmWorkerProcess pid=3236834)[0;0m  (warnings.py:110)[0m
[1;36m(VllmWorkerProcess pid=3236835)[0;0m  (warnings.py:110)[0m
[1;36m(VllmWorkerProcess pid=3236829)[0;0m [2025-04-12 11:08:42,408] [[33m WARNING[0m]: ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/vllm/worker/model_runner.py:1828: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[1;36m(VllmWorkerProcess pid=3236829)[0;0m   lm_head_weight = torch.load(lm_local, map_location=hidden_states_cur.device).to(dtype=torch.bfloat16)
[1;36m(VllmWorkerProcess pid=3236829)[0;0m  (warnings.py:110)[0m
[2025-04-12 11:08:42,408] [[33m WARNING[0m]: ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/vllm/worker/model_runner.py:1828: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  lm_head_weight = torch.load(lm_local, map_location=hidden_states_cur.device).to(dtype=torch.bfloat16)
 (warnings.py:110)[0m
[1;36m(VllmWorkerProcess pid=3236831)[0;0m [2025-04-12 11:08:42,408] [[33m WARNING[0m]: ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/vllm/worker/model_runner.py:1828: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[1;36m(VllmWorkerProcess pid=3236831)[0;0m   lm_head_weight = torch.load(lm_local, map_location=hidden_states_cur.device).to(dtype=torch.bfloat16)
[1;36m(VllmWorkerProcess pid=3236831)[0;0m  (warnings.py:110)[0m
[1;36m(VllmWorkerProcess pid=3236830)[0;0m [2025-04-12 11:08:42,408] [[33m WARNING[0m]: ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/vllm/worker/model_runner.py:1828: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[1;36m(VllmWorkerProcess pid=3236830)[0;0m   lm_head_weight = torch.load(lm_local, map_location=hidden_states_cur.device).to(dtype=torch.bfloat16)
[1;36m(VllmWorkerProcess pid=3236830)[0;0m  (warnings.py:110)[0m
[1;36m(VllmWorkerProcess pid=3236834)[0;0m DEBUG - Starting CHOT optimization
[1;36m(VllmWorkerProcess pid=3236834)[0;0m DEBUG - CHOT parameters: steps=5, lr=0.01
[1;36m(VllmWorkerProcess pid=3236834)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236834)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236834)[0;0m cuda:6 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236834)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236834)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236834)[0;0m cuda:6 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236834)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236834)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236834)[0;0m cuda:6 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236834)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236834)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236834)[0;0m cuda:6 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236834)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236834)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236834)[0;0m cuda:6 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:49 worker.py:267] Memory profiling takes 9.35 seconds
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:49 worker.py:267] the current vLLM instance can use total_gpu_memory (79.22GiB) x gpu_memory_utilization (0.99) = 78.42GiB
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:49 worker.py:267] model weights take 1.90GiB; non_torch_memory takes 3.48GiB; PyTorch activation peak memory takes 40.90GiB; the rest of the memory reserved for KV Cache is 32.14GiB.
[1;36m(VllmWorkerProcess pid=3236832)[0;0m DEBUG - Starting CHOT optimization
[1;36m(VllmWorkerProcess pid=3236832)[0;0m DEBUG - CHOT parameters: steps=5, lr=0.01
[1;36m(VllmWorkerProcess pid=3236832)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236832)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236832)[0;0m cuda:4 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236832)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236832)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236832)[0;0m cuda:4 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236832)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236832)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236832)[0;0m cuda:4 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236832)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236832)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236832)[0;0m cuda:4 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236832)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236832)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236832)[0;0m cuda:4 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:49 worker.py:267] Memory profiling takes 9.37 seconds
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:49 worker.py:267] the current vLLM instance can use total_gpu_memory (79.22GiB) x gpu_memory_utilization (0.99) = 78.42GiB
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:49 worker.py:267] model weights take 1.90GiB; non_torch_memory takes 3.48GiB; PyTorch activation peak memory takes 40.90GiB; the rest of the memory reserved for KV Cache is 32.14GiB.
[1;36m(VllmWorkerProcess pid=3236833)[0;0m DEBUG - Starting CHOT optimization
[1;36m(VllmWorkerProcess pid=3236833)[0;0m DEBUG - CHOT parameters: steps=5, lr=0.01
[1;36m(VllmWorkerProcess pid=3236833)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236833)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236833)[0;0m cuda:5 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236833)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236833)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236833)[0;0m cuda:5 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236833)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236833)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236833)[0;0m cuda:5 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236833)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236833)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236833)[0;0m cuda:5 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236833)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236833)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236833)[0;0m cuda:5 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:49 worker.py:267] Memory profiling takes 9.36 seconds
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:49 worker.py:267] the current vLLM instance can use total_gpu_memory (79.22GiB) x gpu_memory_utilization (0.99) = 78.42GiB
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:49 worker.py:267] model weights take 1.90GiB; non_torch_memory takes 3.48GiB; PyTorch activation peak memory takes 40.90GiB; the rest of the memory reserved for KV Cache is 32.14GiB.
[1;36m(VllmWorkerProcess pid=3236835)[0;0m DEBUG - Starting CHOT optimization
[1;36m(VllmWorkerProcess pid=3236835)[0;0m DEBUG - CHOT parameters: steps=5, lr=0.01
[1;36m(VllmWorkerProcess pid=3236835)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236835)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236835)[0;0m cuda:7 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236835)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236835)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236835)[0;0m cuda:7 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236835)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236835)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236835)[0;0m cuda:7 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236835)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236835)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236835)[0;0m cuda:7 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236835)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236835)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236835)[0;0m cuda:7 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:49 worker.py:267] Memory profiling takes 9.37 seconds
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:49 worker.py:267] the current vLLM instance can use total_gpu_memory (79.22GiB) x gpu_memory_utilization (0.99) = 78.42GiB
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:49 worker.py:267] model weights take 1.90GiB; non_torch_memory takes 3.17GiB; PyTorch activation peak memory takes 40.90GiB; the rest of the memory reserved for KV Cache is 32.45GiB.
[1;36m(VllmWorkerProcess pid=3236830)[0;0m DEBUG - Starting CHOT optimization
[1;36m(VllmWorkerProcess pid=3236830)[0;0m DEBUG - CHOT parameters: steps=5, lr=0.01
[1;36m(VllmWorkerProcess pid=3236830)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236830)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236830)[0;0m cuda:2 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236830)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236830)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236830)[0;0m cuda:2 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236830)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236830)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236830)[0;0m cuda:2 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236830)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236830)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236830)[0;0m cuda:2 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236830)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236830)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236830)[0;0m cuda:2 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:49 worker.py:267] Memory profiling takes 9.41 seconds
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:49 worker.py:267] the current vLLM instance can use total_gpu_memory (79.22GiB) x gpu_memory_utilization (0.99) = 78.42GiB
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:49 worker.py:267] model weights take 1.90GiB; non_torch_memory takes 3.48GiB; PyTorch activation peak memory takes 40.90GiB; the rest of the memory reserved for KV Cache is 32.14GiB.
[1;36m(VllmWorkerProcess pid=3236831)[0;0m DEBUG - Starting CHOT optimization
[1;36m(VllmWorkerProcess pid=3236831)[0;0m DEBUG - CHOT parameters: steps=5, lr=0.01
[1;36m(VllmWorkerProcess pid=3236831)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236831)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236831)[0;0m cuda:3 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236831)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236831)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236831)[0;0m cuda:3 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236831)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236831)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236831)[0;0m cuda:3 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236831)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236831)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236831)[0;0m cuda:3 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236831)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236831)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236831)[0;0m cuda:3 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:49 worker.py:267] Memory profiling takes 9.41 seconds
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:49 worker.py:267] the current vLLM instance can use total_gpu_memory (79.22GiB) x gpu_memory_utilization (0.99) = 78.42GiB
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:49 worker.py:267] model weights take 1.90GiB; non_torch_memory takes 3.48GiB; PyTorch activation peak memory takes 40.90GiB; the rest of the memory reserved for KV Cache is 32.14GiB.
[1;36m(VllmWorkerProcess pid=3236829)[0;0m DEBUG - Starting CHOT optimization
[1;36m(VllmWorkerProcess pid=3236829)[0;0m DEBUG - CHOT parameters: steps=5, lr=0.01
[1;36m(VllmWorkerProcess pid=3236829)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236829)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236829)[0;0m cuda:1 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236829)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236829)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236829)[0;0m cuda:1 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236829)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236829)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236829)[0;0m cuda:1 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236829)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236829)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236829)[0;0m cuda:1 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236829)[0;0m DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
[1;36m(VllmWorkerProcess pid=3236829)[0;0m Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
[1;36m(VllmWorkerProcess pid=3236829)[0;0m cuda:1 torch.Size([128256, 4096])
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:49 worker.py:267] Memory profiling takes 9.54 seconds
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:49 worker.py:267] the current vLLM instance can use total_gpu_memory (79.22GiB) x gpu_memory_utilization (0.99) = 78.42GiB
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:49 worker.py:267] model weights take 1.90GiB; non_torch_memory takes 3.48GiB; PyTorch activation peak memory takes 40.90GiB; the rest of the memory reserved for KV Cache is 32.14GiB.
[2025-04-12 11:08:49,725] [[32m    INFO[0m]: Memory profiling takes 9.46 seconds
the current vLLM instance can use total_gpu_memory (79.22GiB) x gpu_memory_utilization (0.99) = 78.42GiB
model weights take 1.90GiB; non_torch_memory takes 4.48GiB; PyTorch activation peak memory takes 40.90GiB; the rest of the memory reserved for KV Cache is 31.14GiB. (worker.py:267)[0m
[2025-04-12 11:08:49,934] [[32m    INFO[0m]: # CUDA blocks: 127542, # CPU blocks: 16384 (executor_base.py:110)[0m
[2025-04-12 11:08:49,934] [[32m    INFO[0m]: Maximum concurrency for 32768 tokens per request: 62.28x (executor_base.py:115)[0m
[2025-04-12 11:08:51,777] [[32m    INFO[0m]: Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage. (model_runner.py:1434)[0m
DEBUG - Starting CHOT optimization
DEBUG - CHOT parameters: steps=5, lr=0.01
DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])
DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])
DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])
DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])
DEBUG - hidden_states_orig: torch.Size([32768, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])

Capturing CUDA graph shapes:   0%|          | 0/19 [00:00<?, ?it/s][1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:51 model_runner.py:1434] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:08:51 model_runner.py:1434] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:08:51 model_runner.py:1434] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:08:51 model_runner.py:1434] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:08:51 model_runner.py:1434] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:08:51 model_runner.py:1434] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:51 model_runner.py:1434] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.

Capturing CUDA graph shapes:   5%|â–Œ         | 1/19 [00:00<00:08,  2.20it/s]
Capturing CUDA graph shapes:  11%|â–ˆ         | 2/19 [00:00<00:07,  2.20it/s]
Capturing CUDA graph shapes:  16%|â–ˆâ–Œ        | 3/19 [00:01<00:07,  2.16it/s]
Capturing CUDA graph shapes:  21%|â–ˆâ–ˆ        | 4/19 [00:01<00:06,  2.18it/s]
Capturing CUDA graph shapes:  26%|â–ˆâ–ˆâ–‹       | 5/19 [00:02<00:06,  2.17it/s]
Capturing CUDA graph shapes:  32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:02<00:05,  2.18it/s]
Capturing CUDA graph shapes:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:03<00:05,  2.20it/s]
Capturing CUDA graph shapes:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:03<00:04,  2.20it/s]
Capturing CUDA graph shapes:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:04<00:04,  2.20it/s]
Capturing CUDA graph shapes:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:04<00:04,  2.18it/s]
Capturing CUDA graph shapes:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:05<00:03,  2.13it/s]
Capturing CUDA graph shapes:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:05<00:03,  2.13it/s]
Capturing CUDA graph shapes:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:06<00:02,  2.10it/s]
Capturing CUDA graph shapes:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:06<00:02,  2.07it/s]
Capturing CUDA graph shapes:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:06<00:01,  2.11it/s]
Capturing CUDA graph shapes:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:07<00:01,  2.13it/s]
Capturing CUDA graph shapes:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:07<00:00,  2.16it/s][1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:08:59 custom_all_reduce.py:226] Registering 1235 cuda graph addresses
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:08:59 custom_all_reduce.py:226] Registering 1235 cuda graph addresses
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:09:00 custom_all_reduce.py:226] Registering 1235 cuda graph addresses
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:09:00 custom_all_reduce.py:226] Registering 1235 cuda graph addresses
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:09:00 custom_all_reduce.py:226] Registering 1235 cuda graph addresses

Capturing CUDA graph shapes:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:08<00:00,  2.20it/s][1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:09:00 custom_all_reduce.py:226] Registering 1235 cuda graph addresses
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:09:00 custom_all_reduce.py:226] Registering 1235 cuda graph addresses

Capturing CUDA graph shapes: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:08<00:00,  1.95it/s]
Capturing CUDA graph shapes: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:08<00:00,  2.12it/s]
[2025-04-12 11:09:00,755] [[32m    INFO[0m]: Registering 1235 cuda graph addresses (custom_all_reduce.py:226)[0m
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:09:01 model_runner.py:1562] Graph capturing finished in 9 secs, took 0.13 GiB
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:09:01 model_runner.py:1562] Graph capturing finished in 9 secs, took 0.13 GiB
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:09:01 model_runner.py:1562] Graph capturing finished in 9 secs, took 0.13 GiB
[2025-04-12 11:09:01,174] [[32m    INFO[0m]: Graph capturing finished in 9 secs, took 0.13 GiB (model_runner.py:1562)[0m
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:09:01 model_runner.py:1562] Graph capturing finished in 9 secs, took 0.13 GiB
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:09:01 model_runner.py:1562] Graph capturing finished in 9 secs, took 0.13 GiB
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:09:01 model_runner.py:1562] Graph capturing finished in 9 secs, took 0.13 GiB
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:09:01 model_runner.py:1562] Graph capturing finished in 9 secs, took 0.13 GiB
[2025-04-12 11:09:01,185] [[32m    INFO[0m]: init engine (profile, create kv cache, warmup model) took 21.23 seconds (llm_engine.py:431)[0m
[2025-04-12 11:09:02,601] [[32m    INFO[0m]: --- INIT SEEDS --- (pipeline.py:263)[0m
[2025-04-12 11:09:02,601] [[32m    INFO[0m]: --- LOADING TASKS --- (pipeline.py:216)[0m
[2025-04-12 11:09:02,601] [[32m    INFO[0m]: Found 1 custom tasks in ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/lighteval/tasks/extended/ifeval/main.py (registry.py:142)[0m
[2025-04-12 11:09:02,601] [[32m    INFO[0m]: Found 6 custom tasks in ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/lighteval/tasks/extended/tiny_benchmarks/main.py (registry.py:142)[0m
[2025-04-12 11:09:02,601] [[32m    INFO[0m]: Found 1 custom tasks in ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/lighteval/tasks/extended/mt_bench/main.py (registry.py:142)[0m
[2025-04-12 11:09:02,601] [[32m    INFO[0m]: Found 4 custom tasks in ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/lighteval/tasks/extended/mix_eval/main.py (registry.py:142)[0m
[2025-04-12 11:09:02,601] [[32m    INFO[0m]: Found 5 custom tasks in ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/lighteval/tasks/extended/olympiade_bench/main.py (registry.py:142)[0m
[2025-04-12 11:09:02,601] [[32m    INFO[0m]: Found 1 custom tasks in ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/lighteval/tasks/extended/hle/main.py (registry.py:142)[0m
[2025-04-12 11:09:02,601] [[32m    INFO[0m]: Found 21 custom tasks in ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/lighteval/tasks/extended/lcb/main.py (registry.py:142)[0m
[2025-04-12 11:09:02,603] [[32m    INFO[0m]: HuggingFaceH4/aime_2024 default (lighteval_task.py:187)[0m
[2025-04-12 11:09:02,603] [[33m WARNING[0m]: Careful, the task lighteval|aime24 is using evaluation data to build the few shot examples. (lighteval_task.py:260)[0m
Using the latest cached version of the dataset since HuggingFaceH4/aime_2024 couldn't be found on the Hugging Face Hub
[2025-04-12 11:10:17,439] [[33m WARNING[0m]: Using the latest cached version of the dataset since HuggingFaceH4/aime_2024 couldn't be found on the Hugging Face Hub (load.py:1377)[0m
Found the latest cached dataset configuration 'default' at ~/.cache/huggingface/datasets/HuggingFaceH4___aime_2024/default/0.0.0/2fe88a2f1091d5048c0f36abc874fb997b3dd99a (last modified on Tue Apr  8 15:12:43 2025).
[2025-04-12 11:10:17,441] [[33m WARNING[0m]: Found the latest cached dataset configuration 'default' at ~/.cache/huggingface/datasets/HuggingFaceH4___aime_2024/default/0.0.0/2fe88a2f1091d5048c0f36abc874fb997b3dd99a (last modified on Tue Apr  8 15:12:43 2025). (cache.py:94)[0m
[2025-04-12 11:10:17,481] [[32m    INFO[0m]: --- RUNNING MODEL --- (pipeline.py:468)[0m
[2025-04-12 11:10:17,481] [[32m    INFO[0m]: Running RequestType.GREEDY_UNTIL requests (pipeline.py:472)[0m
[2025-04-12 11:10:17,489] [[33m WARNING[0m]: You cannot select the number of dataset splits for a generative evaluation at the moment. Automatically inferring. (data.py:260)[0m

Splits:   0%|          | 0/1 [00:00<?, ?it/s][2025-04-12 11:10:17,495] [[33m WARNING[0m]: context_size + max_new_tokens=33249 which is greater than self.max_length=32768. Truncating context to 0 tokens. (vllm_model.py:270)[0m


Processed prompts:   0%|          | 0/30 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A[2025-04-12 11:10:17,587] [[33m WARNING[0m]: ~/Projects/nips25_slot/open-r2/openr1/lib/python3.11/site-packages/vllm/worker/model_runner.py:1828: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  lm_head_weight = torch.load(lm_local, map_location=hidden_states_cur.device).to(dtype=torch.bfloat16)
 (warnings.py:110)[0m


Processed prompts:   3%|â–Ž         | 1/30 [00:05<02:36,  5.40s/it, est. speed input: 33.73 toks/s, output: 96.36 toks/s][A

Processed prompts:   7%|â–‹         | 2/30 [00:06<01:15,  2.69s/it, est. speed input: 61.18 toks/s, output: 187.75 toks/s][A

Processed prompts:  13%|â–ˆâ–Ž        | 4/30 [00:06<00:27,  1.04s/it, est. speed input: 130.10 toks/s, output: 393.16 toks/s][A

Processed prompts:  17%|â–ˆâ–‹        | 5/30 [00:06<00:19,  1.26it/s, est. speed input: 155.96 toks/s, output: 485.26 toks/s][A

Processed prompts:  20%|â–ˆâ–ˆ        | 6/30 [00:06<00:16,  1.48it/s, est. speed input: 170.71 toks/s, output: 566.58 toks/s][A

Processed prompts:  23%|â–ˆâ–ˆâ–Ž       | 7/30 [00:07<00:12,  1.90it/s, est. speed input: 203.71 toks/s, output: 663.07 toks/s][A

Processed prompts:  30%|â–ˆâ–ˆâ–ˆ       | 9/30 [00:07<00:06,  3.28it/s, est. speed input: 251.23 toks/s, output: 876.97 toks/s][A

Processed prompts:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 11/30 [00:07<00:03,  4.87it/s, est. speed input: 291.88 toks/s, output: 1086.77 toks/s][A

Processed prompts:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 13/30 [00:07<00:04,  4.06it/s, est. speed input: 348.84 toks/s, output: 1226.32 toks/s][A

Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15/30 [00:08<00:03,  4.43it/s, est. speed input: 391.55 toks/s, output: 1405.28 toks/s][A

Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 16/30 [00:08<00:03,  4.44it/s, est. speed input: 398.60 toks/s, output: 1490.40 toks/s][A

Processed prompts:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 17/30 [00:08<00:02,  4.47it/s, est. speed input: 417.11 toks/s, output: 1576.58 toks/s][A

Processed prompts:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 18/30 [00:09<00:04,  2.48it/s, est. speed input: 401.64 toks/s, output: 1548.39 toks/s][A

Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 19/30 [00:10<00:04,  2.50it/s, est. speed input: 409.67 toks/s, output: 1619.59 toks/s][A

Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 20/30 [00:11<00:05,  1.74it/s, est. speed input: 389.07 toks/s, output: 1602.47 toks/s][A

Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 21/30 [00:12<00:06,  1.35it/s, est. speed input: 372.01 toks/s, output: 1589.92 toks/s][A

Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 22/30 [05:12<11:22, 85.29s/it, est. speed input: 15.54 toks/s, output: 167.25 toks/s]  [A

Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 23/30 [05:12<07:06, 60.88s/it, est. speed input: 16.17 toks/s, output: 271.12 toks/s][A

Processed prompts:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 25/30 [05:13<02:47, 33.46s/it, est. speed input: 17.42 toks/s, output: 479.04 toks/s][A

Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 27/30 [05:13<01:01, 20.38s/it, est. speed input: 18.57 toks/s, output: 686.89 toks/s][A

Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 28/30 [05:13<00:31, 15.96s/it, est. speed input: 19.08 toks/s, output: 790.56 toks/s][A
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30/30 [05:13<00:00, 10.45s/it, est. speed input: 20.11 toks/s, output: 998.54 toks/s]

Splits: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [05:13<00:00, 313.53s/it]
Splits: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [05:13<00:00, 313.53s/it]
[2025-04-12 11:15:31,722] [[32m    INFO[0m]: Terminating local vLLM worker processes (multiproc_worker_utils.py:141)[0m
[1;36m(VllmWorkerProcess pid=3236831)[0;0m INFO 04-12 11:15:31 multiproc_worker_utils.py:253] Worker exiting
[1;36m(VllmWorkerProcess pid=3236829)[0;0m INFO 04-12 11:15:31 multiproc_worker_utils.py:253] Worker exiting
[1;36m(VllmWorkerProcess pid=3236833)[0;0m INFO 04-12 11:15:31 multiproc_worker_utils.py:253] Worker exiting
[1;36m(VllmWorkerProcess pid=3236830)[0;0m INFO 04-12 11:15:31 multiproc_worker_utils.py:253] Worker exiting
[1;36m(VllmWorkerProcess pid=3236835)[0;0m INFO 04-12 11:15:31 multiproc_worker_utils.py:253] Worker exiting
[1;36m(VllmWorkerProcess pid=3236834)[0;0m INFO 04-12 11:15:31 multiproc_worker_utils.py:253] Worker exiting
[1;36m(VllmWorkerProcess pid=3236832)[0;0m INFO 04-12 11:15:31 multiproc_worker_utils.py:253] Worker exiting
[2025-04-12 11:15:32,509] [[32m    INFO[0m]: --- COMPUTING METRICS --- (pipeline.py:504)[0m
[2025-04-12 11:15:32,987] [[32m    INFO[0m]: --- DISPLAYING RESULTS --- (pipeline.py:546)[0m
[2025-04-12 11:15:32,997] [[32m    INFO[0m]: --- SAVING AND PUSHING RESULTS --- (pipeline.py:536)[0m
[2025-04-12 11:15:32,997] [[32m    INFO[0m]: Saving experiment tracker (evaluation_tracker.py:180)[0m
[2025-04-12 11:15:33,177] [[32m    INFO[0m]: Saving results to ~/Projects/nips25_slot/open-r2/data/evals~/Models/LLM-Research/Meta-Llama-3.1-8B-Instruct/results/_Models_LLM-Research_Meta-Llama-3.1-8B-Instruct/results_2025-04-12T11-15-32.997869.json (evaluation_tracker.py:234)[0m
DEBUG - Starting CHOT optimization
DEBUG - CHOT parameters: steps=5, lr=0.01
DEBUG - hidden_states_orig: torch.Size([6302, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])
DEBUG - hidden_states_orig: torch.Size([6302, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])
DEBUG - hidden_states_orig: torch.Size([6302, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])
DEBUG - hidden_states_orig: torch.Size([6302, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])
DEBUG - hidden_states_orig: torch.Size([6302, 4096]), torch.bfloat16
Loading lm_local from: lm_head/Meta-Llama-3.1-8B-Instruct_lm_head.pt
cuda:0 torch.Size([128256, 4096])
|       Task       |Version|     Metric     |Value|   |Stderr|
|------------------|------:|----------------|----:|---|-----:|
|all               |       |extractive_match|  0.1|Â±  |0.0557|
|lighteval:aime24:0|      1|extractive_match|  0.1|Â±  |0.0557|

